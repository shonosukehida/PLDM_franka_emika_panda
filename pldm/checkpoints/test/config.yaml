env_name: wall
n_steps: 16
val_n_steps: 16
l1_n_steps: 17
wandb: true
run_name: test
run_group: test
run_project: HJEPA-wall
output_root: ./checkpoints
output_dir: test
eval_mpcs: 20
quick_debug: false
seed: 101
load_checkpoint_path: null
load_l1_only: false
eval_only: false
train_only: false
epochs: 2
base_lr: 0.0007
disable_l2: true
optimizer_type: Adam
optimizer_schedule: Cosine
data:
  dataset_type: Wall
  dot_config:
    size: 10000
    val_size: 10000
    batch_size: 128
    dot_std: 1.3
    action_noise: 0.2
    action_angle_noise: 0.15
    action_step_mean: 1.0
    action_step_std: 0.4
    action_lower_bd: 0.2
    action_upper_bd: 1.8
    action_bias_only: false
    max_step: 1.0
    n_steps: 16
    img_size: 64
    train: true
    device: cuda:2
    repeat_actions: 1
    n_steps_reduce_factor: 1
    border_wall_loc: 5
    action_param_xy: true
    chunked_actions: false
  wall_config:
    size: 20000
    val_size: 10000
    batch_size: 64
    dot_std: 1.3
    action_noise: 1.0
    action_angle_noise: 0.2
    action_step_mean: 1.0
    action_step_std: 0.4
    action_lower_bd: 0.2
    action_upper_bd: 1.8
    action_bias_only: false
    max_step: 1.0
    n_steps: 16
    img_size: 65
    train: true
    device: cuda
    repeat_actions: 1
    n_steps_reduce_factor: 1
    border_wall_loc: 5
    action_param_xy: true
    chunked_actions: false
    fix_wall: true
    fix_wall_batch_k: null
    wall_padding: 20
    door_padding: 10
    wall_width: 3
    door_space: 4
    cross_wall_rate: 0.08
    expert_cross_wall_rate: 0.0
    expert_action_step_mean: 0.9
    expert_action_step_std: 0.0
    expert_action_lower_bd: 0.9
    expert_action_upper_bd: 0.9
    expert_traj_door_padding: 2.0
    exclude_wall_train: ''
    exclude_door_train: ''
    only_wall_val: ''
    only_door_val: ''
    fix_wall_location: 32
    fix_door_location: 10
    num_train_layouts: -1
    image_based: true
  offline_wall_config:
    batch_size: 64
    img_size: 65
    train: true
    device: cuda:2
    repeat_actions: 1
    image_based: true
    use_offline: true
    offline_data_path: /home/hida/PLDM/pldm_envs/wall/presaved_datasets/rendered/good_quality_data.npz
    lazy_load: false
    n_steps: 16
    chunked_actions: false
  wall_expert_config:
    size: 10000
    val_size: 10000
    batch_size: 128
    dot_std: 1.3
    action_noise: 0.2
    action_angle_noise: 0.15
    action_step_mean: 1.0
    action_step_std: 0.4
    action_lower_bd: 0.2
    action_upper_bd: 1.8
    action_bias_only: false
    max_step: 1.0
    n_steps: 91
    img_size: 64
    train: true
    device: cuda:2
    repeat_actions: 1
    n_steps_reduce_factor: 1
    border_wall_loc: 5
    action_param_xy: true
    chunked_actions: false
    fix_wall: true
    fix_wall_batch_k: null
    wall_padding: 20
    door_padding: 10
    wall_width: 3
    door_space: 4
    cross_wall_rate: 0.1
    expert_cross_wall_rate: 0.0
    expert_action_step_mean: 0.9
    expert_action_step_std: 0.0
    expert_action_lower_bd: 0.9
    expert_action_upper_bd: 0.9
    expert_traj_door_padding: 2.0
    exclude_wall_train: ''
    exclude_door_train: ''
    only_wall_val: ''
    only_door_val: ''
    fix_wall_location: 32
    fix_door_location: 10
    num_train_layouts: -1
    image_based: true
    expert_fraction: 0.5
    max_step_expert: 2.0
    num_workers: 16
  d4rl_config:
    env_name: ???
    num_workers: 10
    batch_size: 1024
    seed: 0
    normalize: true
    quick_debug: false
    val_fraction: 0.2
    train: true
    sample_length: 17
    location_only: false
    path: null
    images_path: null
    val_path: null
    prioritized: false
    alpha: 0.6
    beta: 0.4
    crop_length: null
    stack_states: 1
    mixture_expert: 0.0
    img_size: 64
    random_actions: false
    load_top_down_view: false
    image_based: true
    chunked_actions: false
    substitute_action: null
  normalize: true
  min_max_normalize_state: true
  normalizer_hardset: false
  quick_debug: false
  num_workers: 0
objectives_l1:
  objectives:
  - VICReg
  - IDM
  vicreg:
    projector: id
    random_projector: false
    sim_coeff: 1.0
    std_coeff: 3.9843
    cov_coeff: 6.9238
    std_coeff_t: 0.24535
    cov_coeff_t: 0.0
    cov_per_feature: false
    adjust_cov: true
    cov_chunk_size: null
    std_margin: 1.0
    std_margin_t: 1.0
    sim_coeff_t: 0.74242
  vicreg_obs:
    projector: id
    random_projector: false
    sim_coeff: 25.0
    std_coeff: 25.0
    cov_coeff: 1.0
    std_coeff_t: 0.0
    cov_coeff_t: 0.0
    cov_per_feature: false
    adjust_cov: true
    cov_chunk_size: null
    std_margin: 1.0
    std_margin_t: 1.0
    sim_coeff_t: 0.0
  vicreg_propio:
    projector: id
    random_projector: false
    sim_coeff: 25.0
    std_coeff: 25.0
    cov_coeff: 1.0
    std_coeff_t: 0.0
    cov_coeff_t: 0.0
    cov_per_feature: false
    adjust_cov: true
    cov_chunk_size: null
    std_margin: 1.0
    std_margin_t: 1.0
    sim_coeff_t: 0.0
  idm:
    coeff: 1.072
    action_dim: 2
    arch: '512'
    arch_subclass: a
    use_pred: false
  prediction:
    global_coeff: 1.0
  prediction_obs:
    global_coeff: 1.0
  prediction_propio:
    global_coeff: 1.0
eval_at_beginning: false
eval_during_training: false
save_every_n_epochs: 5
eval_every_n_epochs: 20
hjepa:
  level1:
    backbone:
      arch: impala
      backbone_subclass: i
      backbone_width_factor: 2
      backbone_mlp: null
      backbone_norm: group_norm
      backbone_pool: dim_reduce
      backbone_final_fc: false
      channels: 2
      input_dim: null
      propio_dim: null
      propio_encoder_arch: null
      fc_output_dim: null
      final_ln: true
    predictor:
      predictor_arch: rnnV2
      predictor_subclass: 512-512
      predictor_ln: true
      rnn_state_dim: 512
      rnn_converter_arch: ''
      z_discrete: false
      z_discrete_dim: 16
      z_discrete_dists: 16
      z_dim: 0
      z_min_std: 0.1
      posterior_drop_p: 0.0
      prior_arch: '512'
      posterior_arch: '512'
      posterior_input_type: term_states
      posterior_input_dim: null
      action_encoder_arch: ''
      residual: true
      rnn_layers: 1
      tie_backbone_ln: true
    action_dim: 2
    momentum: 0.0
    use_z_goal: false
    encode_only: false
  step_skip: 4
  disable_l2: true
  freeze_l1: false
  train_l1: true
  l1_n_steps: 16
resume_if_possible: true
compile_model: true
eval_cfg:
  env_name: wall
  probing:
    probe_targets: locations
    l2_probe_targets: locations
    locations:
      arch: '512'
      subclass: null
    propio_pos:
      arch: null
      subclass: null
    propio_vel:
      arch: null
      subclass: null
    full_finetune: false
    lr: 0.0002
    epochs: 20
    epochs_enc: 30
    max_samples: null
    max_samples_enc: null
    schedule: Constant
    sample_timesteps: 30
    prober_arch: ''
    epochs_latent: 5
    l1_depth: 16
    l2_depth: 91
    probe_propio: true
    probe_mpc: false
    probe_wall: true
    probe_border: false
    probe_encoder: true
    probe_preds: true
    probe_expert: false
    visualize_probing: true
    load_prober: false
    arch_subclass: a
    train_images_path: null
    train_path: null
    val_images_path: null
    val_path: null
    eval_contrastive: false
  eval_l1: true
  eval_l2: false
  log_heatmap: false
  disable_planning: false
  wall_planning:
    env_name: wall
    n_envs: 100
    n_envs_batch_size: 20
    n_steps: 200
    visualize_planning: true
    level1:
      planner_type: MPPI
      sgd:
        n_iters: 900
        lr: 0.3
        l2_reg: 0.0
        action_change_reg: 0.0
        z_reg_coeff: 0.0
      mppi:
        noise_sigma: 12.0
        num_samples: 2000
        lambda_: 0.005
        z_reg_coeff: 0.0
      lfgbs:
        history_size: 10
        max_iter: 20
      clamp_actions: false
      min_step: 0.0
      max_step: 2.45
      repr_target: true
      loss_coeff_first: 0.1
      loss_coeff_last: 1.0
      sum_all_diffs: false
      min_plan_length: 1
      max_plan_length: 96
      depth_probe_threshold: 25
      probe_depth: false
      sum_last_n: 3
      propio_cost: false
      projected_cost: false
    plot_failure_only: false
    log_pred_dist_every: 9223372036854775807
    plot_every: 16
    data_path: ''
    action_repeat: 1
    action_repeat_mode: 'null'
    img_size: 64
    replan_every: 1
    image_obs: false
    stack_states: 1
    random_actions: false
    offline_T: 10
    start_target_from_data: false
    set_start_target_path: null
    levels: medium
    easy:
      n_steps: 50
      n_envs: 100
      max_plan_length: 96
      offline_T: 10
      plot_every: 2
      override_config: true
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    medium:
      n_steps: 200
      n_envs: 100
      max_plan_length: 96
      offline_T: 10
      plot_every: 2
      override_config: true
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    hard:
      n_steps: 30
      n_envs: 4
      max_plan_length: 10
      offline_T: 10
      plot_every: 2
      override_config: false
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    ogbench:
      n_steps: 30
      n_envs: 4
      max_plan_length: 10
      offline_T: 10
      plot_every: 2
      override_config: false
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    discount: 1.0
    level: medium
    seed: 42
    sample_y_min: 32
    sample_y_max: 60
    padding: 5
    error_threshold: 1.0
  d4rl_planning:
    env_name: wall
    n_envs: 4
    n_envs_batch_size: 4
    n_steps: 200
    visualize_planning: true
    level1:
      planner_type: SGD
      sgd:
        n_iters: 100
        lr: 0.01
        l2_reg: 0.0
        action_change_reg: 0.0
        z_reg_coeff: 0.0
      mppi:
        noise_sigma: 5.0
        num_samples: 500
        lambda_: 0.005
        z_reg_coeff: 0.0
      lfgbs:
        history_size: 10
        max_iter: 20
      clamp_actions: false
      min_step: 0.1
      max_step: 1.0
      repr_target: false
      loss_coeff_first: 0.1
      loss_coeff_last: 1.0
      sum_all_diffs: false
      min_plan_length: 1
      max_plan_length: 26
      depth_probe_threshold: 25
      probe_depth: false
      sum_last_n: 3
      propio_cost: false
      projected_cost: false
    plot_failure_only: false
    log_pred_dist_every: 9223372036854775807
    plot_every: 16
    data_path: ''
    action_repeat: 1
    action_repeat_mode: 'null'
    img_size: 64
    replan_every: 1
    image_obs: false
    stack_states: 1
    random_actions: false
    offline_T: 10
    start_target_from_data: false
    set_start_target_path: null
    levels: ''
    easy:
      n_steps: 30
      n_envs: 4
      max_plan_length: 10
      offline_T: 10
      plot_every: 2
      override_config: false
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    medium:
      n_steps: 30
      n_envs: 4
      max_plan_length: 10
      offline_T: 10
      plot_every: 2
      override_config: false
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    hard:
      n_steps: 30
      n_envs: 4
      max_plan_length: 10
      offline_T: 10
      plot_every: 2
      override_config: false
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    ogbench:
      n_steps: 30
      n_envs: 4
      max_plan_length: 10
      offline_T: 10
      plot_every: 2
      override_config: false
      min_block_radius: -1
      max_block_radius: 9223372036854775807
    level: random
    position_only: true
    subgoal_planning: false
    set_full_states: false
    unique_shortest_path: false
